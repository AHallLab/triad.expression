<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Computing Triad expression balance • triad.expression</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Computing Triad expression balance">
<meta property="og:description" content="triad.expression">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">triad.expression</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/triad-balance.html">Computing Triad expression balance</a>
    </li>
    <li>
      <a href="../articles/triad-rhythms.html">Plotting Triad circadian rhythms</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="triad-balance_files/header-attrs-2.11/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Computing Triad expression balance</h1>
                        <h4 class="author">Ben J. Ward</h4>
            
            <h4 class="date">2021-10-07</h4>
      
      
      <div class="hidden name"><code>triad-balance.Rmd</code></div>

    </div>

    
    
<div id="required-data" class="section level2">
<h2 class="hasAnchor">
<a href="#required-data" class="anchor"></a>Required data</h2>
<p>To begin to compute Triad expression balance, we need three sources of data:</p>
<ol style="list-style-type: decimal">
<li>Gene expression data</li>
<li>Gene expression metadata</li>
<li>Triad homology data</li>
</ol>
<p>As an example, we will use the ones provided with the package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">triad.expression</span><span class="op">)</span></code></pre></div>
<pre><code>## Loading required package: ggplot2</code></pre>
<pre><code>## Registered S3 methods overwritten by 'ggtern':
##   method           from   
##   grid.draw.ggplot ggplot2
##   plot.ggplot      ggplot2
##   print.ggplot     ggplot2</code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">expression_data</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">expression_metadata</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">triad_homology</span><span class="op">)</span></code></pre></div>
</div>
<div id="computing-mean-expression-levels" class="section level2">
<h2 class="hasAnchor">
<a href="#computing-mean-expression-levels" class="anchor"></a>Computing mean expression levels</h2>
<p>Before we compute the Triad expression balance, we must first compute the mean expression for each gene in each triad. We do this with the function <code>triad_expression_means_by_factors</code>.</p>
<p>This function takes the expression datasets, and the triad homology information, and a list of metadata column names to use as factor groupings.</p>
<p>For example, in <code>expression_metadata</code>, there is a column called “High.level.variety”, with a level for each variety of wheat.</p>
<p>To compute the mean expression level for each triad gene, for each variety then, we can use the function like so, passing in the expression and homology data, and “High.level.variety” as our factor.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">meanExpressionByVariety</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/triad_expression_means_by_factors.html">triad_expression_means_by_factors</a></span><span class="op">(</span>
  <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="va">expression_data</span><span class="op">)</span>,
  <span class="va">expression_metadata</span>,
  <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="va">triad_homology</span><span class="op">)</span>,
  <span class="st">"High.level.variety"</span>
<span class="op">)</span></code></pre></div>
<p>This function can also handle multiple factors.</p>
<p>For example, what if you wanted to look at triad expression between varieties, AND also for different tissues?</p>
<p>The metadata table we are using, also has a column called “High.level.tissue”, and so clearly some expression experiments used samples from different wheat tissues. The column has several levels such as “roots”, “leaves/shoots”, etc.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">meanExpressionByVarietyAndTissue</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/triad_expression_means_by_factors.html">triad_expression_means_by_factors</a></span><span class="op">(</span>
  <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="va">expression_data</span><span class="op">)</span>,
  <span class="va">expression_metadata</span>,
  <span class="va">triad_homology</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"High.level.variety"</span>, <span class="st">"High.level.tissue"</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p>The resulting table contains the mean expression of each gene, for every combination of factor levels - in this case for every combo of “High.level.variety” and “High.level.tissue”.</p>
<p>Next we have to normalize the data, which is done with the function <code>normalize_triad_expression_means</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">normalizedMeans</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/normalize_triad_expression_means.html">normalize_triad_expression_means</a></span><span class="op">(</span>
  <span class="va">meanExpressionByVarietyAndTissue</span>
<span class="op">)</span></code></pre></div>
<p>By default, this function is able to work out which columns are factors from the previous step (in this instance, “High.level.tissue” and “High.level.variety”) but you can optionally override this should it be necessary (it probably won’t be).</p>
</div>
<div id="computing-triad-expression-balance" class="section level2">
<h2 class="hasAnchor">
<a href="#computing-triad-expression-balance" class="anchor"></a>Computing triad expression balance</h2>
<p>Once you have normalized mean triad expression data, you can compute each triads expression balance, there are 7 different expression balances that could be assigned to each triad as a result.</p>
<ul>
<li>Central</li>
<li>A dominant</li>
<li>B dominant</li>
<li>C dominant</li>
<li>A suppressed</li>
<li>B suppressed</li>
<li>D suppressed</li>
</ul>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">eBalances</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/triad_balance.html">triad_balance</a></span><span class="op">(</span><span class="va">normalizedMeans</span><span class="op">)</span></code></pre></div>
<p>By default, as with the <code>normalize_triad_expression_means</code> function, this function is able to work out which columns are factors from the previous steps (in this instance, “High.level.tissue” and “High.level.variety”) but you can optionally override this should it be necessary (again, it probably won’t be).</p>
<p>And that’s it, you’ve got a data set of the expression balance of each triad!</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Ben Ward.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
